<link rel="import" href="../../polymer/polymer-element.html">

<link rel="import" href="../curium-responsive-layout-layouter-mixin.html">

<script>
  window.Curium = window.Curium || {};
  Curium.CuriumResponsiveLayout = Curium.CuriumResponsiveLayout || {};
  Curium.CuriumResponsiveLayout.Layouter = Curium.CuriumResponsiveLayout.Layouter || {};
  Curium.CuriumResponsiveLayout.Layouter.Default = class extends Curium.CuriumResponsiveLayout.LayouterMixin(Polymer.Element) {

    static get is() { return 'curium-responsive-layout-default-layouter'; }

    static get properties() {
      return {
        layoutMap: {
          type: Object,
          value: () => {}
        },

        _computedLayoutMap: {
          type: Object,
          computed: '_computeLayoutMap(layoutMap)'
        }
      };
    }

    _computeLayoutMap(map) {
      let computed = null;
      if (typeof map === 'string') {
        computed = { 0: map };
      } else if (map !== null && typeof map === 'object') {
        computed = {};
        for (let prop in map) {
          computed[prop] = map[prop];
        }
      }
      return computed;
    }

    layoutContainer(container, containerWidth, childNodes) {
      let widthList = Object.keys(this._computedLayoutMap);
      let selected = -1;
      for (let i = 0; i < widthList.length && containerWidth >= Number.parseInt(widthList[i]); ++i) {
        selected = Number.parseInt(widthList[i]);
      }
      let name = selected >= 0 ? this._computedLayoutMap[selected] : null;
      container._setLayout(name);
    }

  };
  window.customElements.define(Curium.CuriumResponsiveLayout.Layouter.Default.is, Curium.CuriumResponsiveLayout.Layouter.Default);
</script>